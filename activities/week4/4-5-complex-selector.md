# 5. Locating elements where you do not know the id, class or tag

## Concept: locating elements using Xpath

This example uses the driver to make a selection from a dropdown menu before trying to find a value to assert.

The element that changes is the chart. The chart is HTML generated by Plotly, and do you do not have control over the
use of tags, classes, ids etc. within the chart.

Selenium Webdriver locator strategies include using
the [XPATH](https://www.selenium.dev/documentation/webdriver/elements/locators/#xpath) to find an element.

XPath is a language used to navigate and find information in XML documents. Think of XML as a way to store data in a
structured format. XPath helps you point to specific pieces of data within that structure. This can be particularly 
useful when you want to extract or manipulate data from a web page. Essentially, it's like a set of instructions that 
tells a program where to look for the information you want.

Browser tools help you to identify the XPath for an element on the web page. The same tools can also be used to identify the CSS for an element which is included in the example below.

## Use the Chrome inspector to find the XPATH or CSS locator

For example, to find the title displayed in the bar chart.

Run the Dash app, open it in Chrome, right-click on the chart and then Inspect, the
developer console should open with the Element window at the code for the element you clicked on. Expand the elements in
the `<div id='map'>` then `<div class=plot-container plotly>` section until you find the element with `class="main-svg"`
and then the one with `class=infolayer` then `class=g-gtitle`. Once you find the title, if you right-click there are
options to 'copy selector' and 'copy full Xpath'.

![Chrome Inspector to find css selector or xpath](../img/chrome-selector.png)

If you copy the selector, you can then paste to this to your code to define the element:

```python
css_selector = '#line > div.js-plotly-plot > div > div > svg:nth-child(3) > g.infolayer > g.g-gtitle > text'
chart_title = dash_duo.find_element(css_selector)
```

If you copy the XPath it looks more like this which you can then use with the selenium driver `find_element(By.XPATH)`:

```python
from selenium.webdriver.common.by import By

fullxpath = '/html/body/div/div/div/div[3]/div[1]/div/div/div[3]/div[1]/div/div[2]/div/div/svg[2]/g[4]/g[2]/text'
chart_title = dash_duo.driver.find_element(By.XPATH, xpath)
```
## Write a test using the XPath

Try adding and running a test similar to the following

```python
def test_line_chart_selection(dash_duo):
    """
    GIVEN the app is running
    WHEN the dropdown for the line chart is changed to
    THEN the H1 heading text should be "Paralympics Dashboard"
    """
    app = import_app(app_file="paralympics_dash.paralympics_app")
    dash_duo.start_server(app)
    # To find an element by id you use '#id-name'; to find an element by class use '.class-name'
    dash_duo.wait_for_element("#type-dropdown", timeout=2)

    # See https://github.com/plotly/dash/blob/dev/components/dash-core-components/tests/integration/dropdown/test_dynamic_options.py#L31
    # Not easy to follow but give syntax for selecting values in a dropdown list
    dropdown_input = dash_duo.find_element("#type-dropdown")
    dropdown_input.send_keys("Sports")
    dash_duo.driver.implicitly_wait(2)

    # Run the app and use Chrome browser, find the element, right click and choose Select, find the element in the 
    # Elements console and select 'copy selector'. Pate this as the value of the variable e.g. see css_selector below.
    css_selector = '#line > div.js-plotly-plot > div > div > svg:nth-child(3) > g.infolayer > g.g-gtitle > text'
    chart_title = dash_duo.find_element(css_selector)
    assert ("sports" in chart_title.text), "'sports' should appear in the chart title"

```

[Next activity](4-6-actions.md)